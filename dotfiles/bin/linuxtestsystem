#!/bin/bash

display="-vnc 127.0.0.1:8 -daemonize"

if tty -s
then
	if [ "x$1" == "x-vnc" ]
	then 
		display="-vnc 127.0.0.1:8"
    elif [ "x$1" != "x-d" ]
	then 
		display="-curses"
    fi
fi

sudo /usr/bin/kvm \
-M pc-0.12 \
-enable-kvm \
-m 1024 \
-smp 2,sockets=2,cores=1,threads=1 \
-name Test \
-uuid 00dbd6c7-971e-8d88-7ab9-e7e0f21df077 \
-nodefaults \
-rtc base=utc \
-boot order=cn,menu=on \
-drive file=/mnt/multimedia/libvirt/rt1-Test.img,if=ide,format=qcow2,snapshot=on,cache=writeback,boot=on \
-drive file=/mnt/multimedia/libvirt/usbstick.img,if=ide,id=drive-usb-disk0,format=raw,cache=writethrough \
-net nic,macaddr=52:54:00:1a:12:bd,vlan=0,model=rtl8139 \
-net nic,macaddr=52:54:00:ab:5a:35,vlan=0,model=rtl8139 \
-net tap \
-vga cirrus \
-device virtio-balloon-pci,id=balloon0,bus=pci.0,addr=0x6 \
-snapshot \
-usbdevice tablet \
-monitor telnet:127.0.0.1:4444,server,nowait \
$display
#-sdl
#-k de \

#-vnc 127.0.0.1:0 \
